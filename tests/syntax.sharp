mod app;

import std.io;
import std.io.task;
import std.io.fiber;
import platform;
import platform.kernel;

chan := new channel<var>(UNLIMITED);

count := 10;
def main(args: string[]) {

   jb : job;
   for(i := 0; i < count; i++) {
      jb = task.builder() = { ->
         delay(5000);
         print(".");
         chan.send(0);
      };
   }
   chan.read_next(0, count);
}
